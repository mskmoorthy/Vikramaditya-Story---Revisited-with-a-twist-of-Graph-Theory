\chapter{Shortest Paths}
Ajur had found a map of the cemetery. He used it to try to find the best way to go to the water fountain. Then he remembered his recent discussions with Rishnak and excitedly told Jura that by using graph theory methods, they would be able to find a path and maybe even the shortest path to the water fountain.

Rishnak overheard Ajur and realized that a good discussion of paths and shortest paths would be an ideal topic to pursue next.

Rishnak said, ``Consider a graph\footnote{For spanning trees, we consider only undirected graphs; however, for shortest paths we can consider both undirected and directed graphs.} in which you wish to find the shortest path from a specified source vertex to a specified destination vertex. Let's look at this familiar graph.''---Rishnak waved his hands and an undirected graph appeared in front of Ajur [Figure~\ref{12g1}]---``What's the shortest path from vertex~1 to vertex~6?''

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};

  \foreach \from/\to in {n6/n4,n4/n5,n5/n1,n1/n2,n2/n5,n2/n3,n3/n4}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{Example undirected graph for which we want to find the shortest path from vertex~1 to vertex~6}\label{12g1}
\end{center}
\end{figure}

Ajur jumped up and down with excitement and said he could easily draw the shortest path from source vertex~1 to destination vertex~6. He grabbed a stick and drew the graph in the dirt, then he showed the shortest path by thickening edges~$(1,5)$, $(5,4)$, and~$(4,6)$ [Figure~\ref{12g2}].

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};

  \foreach \from/\to in {n6/n4,n4/n5,n5/n1}
    \draw [line width=2 pt,color=blue] (\from) -- (\to);
\foreach \from/\to in {n3/n4,n3/n2,n2/n1,n2/n5}
    \draw  (\from) -- (\to);

\end{tikzpicture}
\caption{The graph from Figure~\ref{12g1} with the shortest Path (of length~3) shown from vertex~1 to vertex~6 using thick lines}\label{12g2}
\end{center}
\end{figure}

Pleased with Ajur's enthusiasm, Rishnak wanted to make sure that Ajur understood a general method for finding the shortest path from a source vertex to a destination vertex in any graph.

Rishnak said, ``Remember how to find a spanning tree for a given graph?''

Ajur said, ``Sure, yes.''

Rishnak said, ``Good. We can come up with a similar algorithm for finding the shortest path from a source vertex to a destination vertex, but first, we need to define distance \textbf{dist} of a vertex~$y$ as the number of vertices we must visit to get from the source vertex to vertex~$y$. We also define parent~\textbf{p} of a vertex as the parent vertex\footnote{You can also think of this as the \textit{previous} vertex.} that led us to vertex~$y$. Given these definitions, here is the algorithm:
\begin{enumerate}
\item Set \textbf{dist} for the source vertex to~0 (since the distance from the source vertex to itself is zero) and set~\textbf{p} as being undefined.
\item Set both \textbf{dist} and~\textbf{p} for all other vertices as being undefined.
\item We start from the source vertex, so add that vertex to a queue.\footnote{In a queue, we can only add elements to the end and remove elements from the front, just like waiting in line at a grocery store. We can also inspect elements in the queue without changing their order.}
\item Remove the vertex from the front of the queue, calling this vertex~$w$. Find all vertices with undefined \textbf{dist} values that are adjacent to~$w$. Set \textbf{dist} for all of these vertices to be one more than the \textbf{dist} value for~$w$; also set~\textbf{p} to be vertex~$w$. Finally, add all of these vertices to the queue.
\item Repeat Step~4 until the destination vertex has its \textbf{dist} value changed, meaning our algorithm has reached the destination vertex. We can then trace the shortest path back to the source vertex by following the~\textbf{p} vertices until we reach the source vertex.''
\end{enumerate}

Ajur knew this was a lot to try to understand. He used the example graph in front of him [Figure~\ref{12g1}], tracing the algorithm from source vertex~1. He said, ``Okay, so we start by letting the distance \textbf{dist} of vertex~1 be~0, then we add vertex~1 to the queue. We remove vertex~1 from the queue. It has adjacent vertices~2 and~5, so the \textbf{dist} values of these vertices are both set to~2. And vertices~2 and~5 are added to the queue, say with vertex~2 at the end of the queue. Also, the parent~\textbf{p} vertices of vertices~2 and~5 are both set to vertex~1.''

Rishnak said, ``Correct. Keep going.''

Ajur went on, ``Next, we remove vertex~5 from the queue. The only adjacent vertex with an undefined \textbf{dist} value is vertex~4, so we add it to the end of the queue. And we set the \textbf{dist} of vertex~4 to be~2 and the parent~\textbf{p} of vertex~4 to be vertex~5.''

Ajur thought for a moment, then said, ``The first element of the queue is now vertex~2, which we remove next. Next, we add the only adjacent vertex---vertex~3---to the queue. For vertex~3, we set \textbf{dist} to~2 (because it is one more than the \textbf(dist) value of vertex~2) and the parent \textbf{p} to vertex~2. Finally, we remove vertex~4 from the queue and therefore reach vertex~6, which we add to the queue. We set the \textbf{dist} of vertex~6 to be~3 and its parent \textbf{p} to vertex~4. And since vertex~6 is the destination vertex, we're done. The distance from vertex~1 to vertex~6 is~3, and we can work backwards to determine the path since \textbf{p}$(6)=4$, \textbf{p}$(4)=5$, and~\textbf{p}$(5)=1$, which is the source vertex.''

Ajur marveled at the systematic procedure that could be applied to any graph. He also realized that this procedure could be used to find the shortest path from a single source to all other vertices in a graph and also shortest path between every pair of vertices. Rishnak added that there is a graph parameter called \textbf{diameter} which is the longest path of the shortest path between every pair of vertices. For the example graph shown in \ref{12g2}, the diameter is 3 (as the shortest paths are of lengths 1, 2 and 3). Finding Ajur's eyes glazed, Rishnak asked him to find the diameter for the following graph \ref{12g3}.  

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};
   
  \foreach \from/\to in {n6/n4,n4/n5,n1/n2,n2/n3,n3/n4}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{ Example graph, for which we We want to find the diameter }\label{12g3}
\end{center}
\end{figure}

Ajur said that this is the graph \ref{12g1} but with two edges (1,5) and (2,5) are removed. Further, Ajur mentioned it is a tree (as there are no cycles in the graph. The longest path among the shortest paths is from vertex 1 to vertex 5 or from vertex 1 to vertex 6. Both of them are of length 4. Diameter of this graph \ref{12g3} is 4. Ajur mentioned that a simple path with $n$ vertices as shown in Figure \ref{12g4}, the diameter is $n$-1.

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n1) at (1,8) {$n$};
  \node (n2) at (3,8)  {$.$};
  \node (n3) at (5,8)  {$.$};
  \node (n4) at (7,8) {$.$};
  \node (n5) at (9,8)  {2};
  \node (n6) at (11,8)  {1};
   
  \foreach \from/\to in {n1/n2,n2/n3,n3/n4,n4/n5,n5/n6}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{ A path graph with n vertices whose diameter is $n-1$ }\label{12g4}
\end{center}
\end{figure}

For a complete graph with $n$ vertices the diameter is 1, as the shortest path between every pair of vertices is 1 (as there is an edge between every pair of vertices in a complete graph). 

Rishnak asked Ajur if he knew how to construct graphs with diameters $n-1, n-1, \cdots, 2, 1$. Ajur replied that it was not hard and added that he would show two graphs one with diameter $n-2$ and the other with diameter 2. From there you could infer that he knew all the answers and drew two figures \ref{12g5} and \ref{12g6}.
\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n1) at (1,8) {$n$};
  \node (n2) at (3,8)  {$.$};
  \node (n3) at (5,8)  {$.$};
  \node (n4) at (7,8) {$.$};
  \node (n5) at (9,10)  {2};
  \node (n6) at (9,8)  {1};
   
  \foreach \from/\to in {n1/n2,n2/n3,n3/n4,n4/n5,n4/n6}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{ A graph with n vertices whose diameter is $n-2$ }\label{12g5}
\end{center}
\end{figure}
\begin{figure}
 \begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \node (n1) at (1,8) {$n$};
  \node (n2) at (1,10)  {$.$};
  \node (n3) at (3,8)  {$.$};
  \node (n4) at (1,6) {$.$};
  \node (n5) at (-1,6)  {2};
  \node (n6) at (-2,8)  {1};
   
  \foreach \from/\to in {n1/n2,n1/n3,n1/n4,n1/n5,n1/n6}
    \draw (\from) -- (\to);

\end{tikzpicture}
\caption{ A graph with n vertices whose diameter is $2$ }\label{12g6}
\end{center}
\end{figure}

Rishnak told Ajur about an interesting problem, that is to construct regular graphs with a given diameter. $k$, $d$ with a number of vertices = $$1+\Sigma_{i=1}^{i=k-1} (d-1)^i$$  Such graphs are called Moore graphs. That formula can be understood by taking a rooted tree of depth $k-1$ with a root vertex has $d$ children and every other vertex has $d-1$ children. All the leaf vertices (vertices of degree 1 in the rooted tree) are connected in such a way that every vertex has degree $d$ and diameter is $k$. (It is no longer a tree). An example of a Moore graph is the Petersen graph \ref{5g4} and is drawn as a rooted tree with leaf vertices connected Figure \ref{12g7}.
\begin{figure}
\begin{tikzpicture}[scale=0.7, every node/.style={circle,fill=red!10},level/.style={sibling distance=60mm/#1}]
\node [circle,draw] (z){$1$}
  child {node [circle,draw] (a) {$2$}
    child {node [circle,draw] (b) {$3$}}
    child {node [circle,draw] (c) {$7$}}}
    child {node [circle,draw] (d) {$5$}
        child {node [circle,draw] (e) {$4$}}
        child {node [circle,draw] (f) {$10$}}}
    child {node [circle,draw] (g) {$6$}
        child {node [circle,draw] (h) {$8$}}
        child {node [circle,draw] (i) {$9$}}};
\path
(b) edge [bend right] (h)
(b) edge [bend right] (e)
(c) edge [bend right] (i)
(c) edge [bend right] (f)
(e) edge [bend right] (i)
(f) edge (h)
;
\end{tikzpicture}
\caption{ Petersen Ggaph drawn as a rooted tree - Its diameter is 2 and it is a regular graph of degree 3 - Same one as in Figure  \ref{5g4}}\label{12g7}
\end{figure}



Ajur then wanted to know if there was an algorithm to find the shortest path in a weighted graph.\footnote{Recollect a weighted graph is a graph with weights on edges.} An example of a weighted graph is shown in Figure \ref{12g8}.
We can modify the algorithm \ref{12a1} for weighted graphs.

\begin{figure} 
\begin{enumerate}
\item  Label of a vertex,$y$, gives the distance from the source vertex to the vertex $y$.  Let the label \textbf{disancet} of the source vertex as 0. The distance from the source vertex to itself is 0. Set label \textbf{distance} all the other vertices as $\infty$. Start from the source vertex. Include that vertex in a queue. \footnote{ In a queue, you can only insert in the rear and delete from the front.} Set label \textbf{explored} of the source as 1 and set the \textbf{explored} of other vertices as 0.
\item Remove the vertex from the front of the queue. Find all vertices $v$, (for which \textbf{explored} label is 0) that is adjacent to the removed vertex ($w$) in. Let the label \textbf{distance} of all these vertices be minimum of the \textbf{dist} label of $v$ and weight of the edge(w,v)+label \textbf{distance} of $w$ .  Set the parent label of $v$ to $w$ if coming from $w$ is shorter. Among all vertices, the \textbf{explored} label of which is 0, choose a vertex $w$ whose \textbf{distance} label is the smallest. Set \textbf{explored} of $w$ to 1 and insert $w$ in the queue.
\item Repeat the above step till the destination vertex gets labeled with a \textbf{dist} label. We can trace the shortest path starting from the destination vertex and its parent vertex, till we reach the source vertex.
\end{enumerate}
\caption{Finding a shortest path from source vertex to a sink vertex.}\label{12a2}
\end{figure}

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \tikzstyle{weight} = [draw=blue!15,shape=rectangle]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};
  \foreach \source /\dest /\weight in {n6/n4/1,n4/n5/2,n5/n1/5,n1/n2/2,n2/n5/2,n2/n3/8,n3/n4/7} 
   \draw (\source) --node[weight] {$\weight$}  (\dest);
\foreach \source /\dest /\weight in {1/3/1} place \weight above of=\path;
  
  \end{tikzpicture}
\caption{ Example weighted Graph with 6 vertices and 7 edges - weights are associated with edges. Find the shortest path from vertex 1 to vertex 6.}\label{12g8}
\end{center}
\end{figure}

Using the algorithm described in \ref{12a2} on the Figure \ref{12g8} we get the following.
Initially \textbf{distance} of 1 is 0 and the rest of the vertices it is $\infty$. \textbf{explore} of vertex 1 is 1 and the rest of the vertices it is 0. \textbf{distance} of vertex 5 gets 5 and \textbf{distance} of vertex 2 gets 2. The labels of parent of vertices 2 gets 1 and parent of 5 gets 1. Then \textbf{explore} of vertex 2 gets 1. Then \textbf{distance} of vertex 5 gets 4 and \textbf{distance} of vertex 3 gets 10 and their parent labels become 2. Now \textbf{explore} of vertex 5 is 1. The label \textbf{distance} of vertex 4 becomes 6 and parent label of 4 becomes 5. The \textbf{explore} of vertex 4 is 1. The \textbf{distance} of 6 vertex becomes 7 and its parent node becomes 4. Note that the label \textbf{distance} of vertex 3 and the parent node of 3 does not get affected. Bow \textbf{explore} of vertex 6 becomes 1 and since it is the destination vertex the algorithm stops. The shortest distance between vertex 1 and vertex is 7 and the shortest path can be traced as 6, parent (6)=4, parent (4)=5, parent of 5=2,parent of 2=1 , the source vertex.
Rishnak drew the following figure \ref{12g9} to illustrate the path.

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \tikzstyle{weight} = [draw=blue!15,shape=rectangle]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};
  \foreach \source /\dest /\weight in {n5/n1/5,n2/n3/8,n3/n4/7} 
   \draw (\source) --node[weight] {$\weight$}  (\dest);
\foreach \source /\dest /\weight in {1/3/1} place \weight above of=\path;
  \foreach \source /\dest /\weight in {n6/n4/1,n4/n5/2,n1/n2/2,n2/n5/2} 
   \draw[color=blue,thick] (\source) --node[weight] {$\weight$}  (\dest); 
  \end{tikzpicture}
\caption{ Example weighted graph with 6 vertices and 7 edges - weights are associated with edges. The shortest path from vertex 1 to vertex 6 is shown.}\label{12g9}
\end{center}
\end{figure}

Ajur appreciated the power of the algorithm, He had seen people using different routes to go from one place to the other. This algorithm may have been used to compute the shortest routes. 

\textbf{Question for Tenth Day}: How will you change the weight of a single edge of the graph in Figure \ref{12g9} so that the shortest path from vertex 1 to vertex 6 will go through vertex 3.

\textbf{Answer:} Ajur thought if the wight of the edge 5 to 4 is increased to 1000, then the shortest path is forced to go through vertex 3 as shown in the following Figure \ref{12qa1}

\begin{figure}
\begin{center}
\begin{tikzpicture}
  [scale=.6,auto=left,every node/.style={circle,fill=red!20}]
  \tikzstyle{weight} = [draw=blue!15,shape=rectangle]
  \node (n6) at (1,10) {6};
  \node (n4) at (4,8)  {4};
  \node (n5) at (8,9)  {5};
  \node (n1) at (11,8) {1};
  \node (n2) at (9,6)  {2};
  \node (n3) at (5,5)  {3};
  \foreach \source /\dest /\weight in {n5/n1/5,n2/n5/2,n5/n4/1000} 
   \draw (\source) --node[weight] {$\weight$}  (\dest);
\foreach \source /\dest /\weight in {1/3/1} place \weight above of=\path;
  \foreach \source /\dest /\weight in {n6/n4/1,n4/n3/7,n3/n2/8,n1/n2/2} 
   \draw[color=blue,thick] (\source) --node[weight] {$\weight$}  (\dest); 
  \end{tikzpicture}
\caption{ Example weighted graph with 6 vertices and 7 edges - weights are associated with edges. The shortest path from vertex 1 to vertex 6 that goes through vertex 3 is shown.}\label{12qa1}
\end{center}
\end{figure}

However, he was getting tired and now wanted to find a shortest path to a bench on which he could lie down and so, along with Jura, drifted off in that direction.